
<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml"  lang="en">

    <head>

        
        <meta charset="UTF-8" />

        
        <meta name="viewport" content="width=device-width, initial-scale=1"/>

                
        <title> 
             Oracle用户角色权限  
        </title>
        
        
            <link href="https://example.com/index.xml" rel="alternate" type="application/rss+xml" title="Kiss&#39;Em!" />
        

        
        <link rel="stylesheet" href="/css/style.css"/>

        
        
            <link rel='stylesheet' href='https://example.com/css/custom.css'>
        
        
    </head>

    <body>



<section class="section">
  <div class="container">
    <nav id="nav-main" class="nav">
      <div id="nav-name" class="nav-left">
        <a id="nav-anchor" class="nav-item" href="https://example.com">
          <h1 id="nav-heading" class="title is-4">Kiss&#39;Em!</h1>
        </a>
      </div>
      <div class="nav-right">
        
        
        <nav id="nav-items" class="nav-item level is-mobile">
          <a class="level-item" aria-label="about" href='/about'
           rel='noopener'>
            <span class="icon">
              <i class>

<svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="8"></line>
    
  </svg></i>
            </span>
          </a>
          <a class="level-item" aria-label="email" href='mailto:info@pavel-pi.de'
           target='_blank'  rel='noopener'>
            <span class="icon">
              <i class>

<svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
    <polyline points="22,6 12,13 2,6"/>
    
  </svg></i>
            </span>
          </a>
          <a class="level-item" aria-label="github" href='https://github.com/pavel-pi'
           target='_blank'  rel='noopener'>
            <span class="icon">
              <i class>

<svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
    
  </svg></i>
            </span>
          </a>
          <a class="level-item" aria-label="twitter" href='https://twitter.com/@_pavel_pi_'
           target='_blank'  rel='noopener'>
            <span class="icon">
              <i class>

<svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
    
  </svg></i>
            </span>
          </a>
          <a class="level-item" aria-label="rss" href='/index.xml'
           target='_blank'  rel='noopener'>
            <span class="icon">
              <i class>

<svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle>
    
  </svg></i>
            </span>
          </a></nav>
        
      
      </div>
    </nav>

    <nav class="nav">
      

      
    </nav>

  </div>
</section>

<section class="section">
    
    <div class="container">
    
        
            
<div class="subtitle tags is-6 is-pulled-right">
    
        
<a class="subtitle is-6" href="/tags/oracle/">#oracle</a>




    
</div>



<h2 class="subtitle is-6">
    
    
        September 27, 2017 | 22:03
    
</h2>



<h1 class="title">Oracle用户角色权限</h1>

<div class="content">

    
    <h1 id="oracle用户角色权限">Oracle用户角色权限</h1>
<h2 id="oracle用户管理">Oracle用户管理</h2>
<p>创建用户</p>
<pre><code>create user username
identified by password
default tablespace tablespace
temporary tablespace tablespace
profile profile
</code></pre><p>查询用户</p>
<pre><code>select username, default_tablespace, temporary_tablespace from dba_users;--查询用户默认表空间，临时表空间
select * from dba_profiles;--查询系统资源文件名
</code></pre><p>创建用户的profile文件</p>
<pre><code> create profile student limit  // student为资源文件名
 FAILED_LOGIN_ATTEMPTS  3  //指定锁定用户的登录失败次数
 PASSWORD_LOCK_TIME 5  //指定用户被锁定天数
 PASSWORD_LIFE_TIME 30  //指定口令可用天数
</code></pre><p>修改用户</p>
<pre><code>1、修改口令字：
SQL&gt;Alter user acc01 identified by &quot;12345&quot;;
2、修改用户缺省表空间：
SQL&gt; Alter user acc01 default tablespace users;
3、修改用户临时表空间
SQL&gt; Alter user acc01 temporary tablespace temp_data;
4、强制用户修改口令字：
SQL&gt; Alter user acc01 password expire;
5、将用户加锁
SQL&gt; Alter user acc01 account lock;  // 加锁
SQL&gt; Alter user acc01 account unlock;  // 解锁
</code></pre><p>监视用户</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#ae81ff">1</span><span style="color:#960050;background-color:#1e0010">、查询用户会话信息：</span>
<span style="color:#66d9ef">SQL</span><span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> username, sid, serial<span style="color:#f92672">#</span>, machine <span style="color:#66d9ef">from</span> v$session;
<span style="color:#ae81ff">2</span><span style="color:#960050;background-color:#1e0010">、删除用户会话信息：</span>
<span style="color:#66d9ef">SQL</span><span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">Alter</span> <span style="color:#66d9ef">system</span> kill <span style="color:#66d9ef">session</span> <span style="color:#e6db74">&#39;sid, serial#&#39;</span>;
<span style="color:#ae81ff">3</span><span style="color:#960050;background-color:#1e0010">、查询用户</span>SQL语句<span style="color:#960050;background-color:#1e0010">：</span>
<span style="color:#66d9ef">SQL</span><span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> user_name, sql_text <span style="color:#66d9ef">from</span> v$open_cursor;
</code></pre></div><p>删除用户</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SQL</span><span style="color:#f92672">&gt;</span><span style="color:#66d9ef">drop</span> <span style="color:#66d9ef">user</span> <span style="color:#960050;background-color:#1e0010">用户名</span>;  <span style="color:#f92672">//</span><span style="color:#960050;background-color:#1e0010">用户没有建任何实体</span>
<span style="color:#66d9ef">SQL</span><span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">drop</span> <span style="color:#66d9ef">user</span> <span style="color:#960050;background-color:#1e0010">用户名</span> <span style="color:#66d9ef">CASCADE</span>;  <span style="color:#f92672">//</span> <span style="color:#960050;background-color:#1e0010">将用户及其所建实体全部删除</span>
<span style="color:#960050;background-color:#1e0010">注意：当前正连接的用户不得删除。</span>
</code></pre></div><h2 id="oracle角色管理">Oracle角色管理</h2>
<p>角色是一组权限的集合，将角色赋给一个用户，这个用户就拥有了这个角色中的所有权限</p>
<h3 id="系统预定义角色">系统预定义角色</h3>
<p>预定义角色是在数据库安装后，系统自动创建的一些常用的角色。</p>
<ol>
<li>
<p>CONNECT, RESOURCE, DBA</p>
</li>
<li>
<p>DELETE_CATALOG_ROLE， EXECUTE_CATALOG_ROLE， SELECT_CATALOG_ROLE
这些角色主要用于访问数据字典视图和包。</p>
</li>
<li>
<p>EXP_FULL_DATABASE， IMP_FULL_DATABASE</p>
<p>这两个角色用于数据导入导出工具的使用。</p>
</li>
<li>
<p>AQ_USERROLE， AQ_ADMINISTRATOR_ROLE</p>
<p>这两个角色用于oracle高级查询功能。</p>
</li>
<li>
<p>SNMPAGENT
用于oracle enterprise manager和Intelligent Agent</p>
</li>
<li>
<p>RECOVERY_CATALOG_OWNER
用于创建拥有恢复库的用户。</p>
</li>
<li>
<p>HS_ADMIN_ROLE
A DBA using Oracle&rsquo;s heterogeneous services feature needs this role to access appropriate tables in the data dictionary.</p>
</li>
</ol>
<h3 id="管理角色">管理角色</h3>
<ol>
<li>
<p>建立一个角色</p>
<p>create role role1;</p>
</li>
<li>
<p>授权给角色</p>
<p>grant create any table,create procedure to role1;</p>
</li>
<li>
<p>授予角色给用户</p>
<p>grant role1 to user1;</p>
</li>
<li>
<p>查看角色所包含的权限</p>
<p>select * from role_sys_privs</p>
</li>
<li>
<p>创建带有口令的角色</p>
<p>create role role1 indentified by password1;</p>
</li>
<li>
<p>修改角色：是否需要口令</p>
<p>alter role role1 not indentified</p>
<p>alter role role1 indentified by password1</p>
</li>
<li>
<p>设置当前用户要生效的角色</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">sql</span><span style="color:#f92672">&gt;</span><span style="color:#66d9ef">set</span> <span style="color:#66d9ef">role</span> role1;<span style="color:#f92672">//</span><span style="color:#960050;background-color:#1e0010">使</span>role1生效
<span style="color:#66d9ef">sql</span><span style="color:#f92672">&gt;</span><span style="color:#66d9ef">set</span> <span style="color:#66d9ef">role</span> <span style="color:#66d9ef">role</span>,role2;<span style="color:#f92672">//</span><span style="color:#960050;background-color:#1e0010">使</span>role1,role2生效
<span style="color:#66d9ef">sql</span><span style="color:#f92672">&gt;</span><span style="color:#66d9ef">set</span> <span style="color:#66d9ef">role</span> role1 identified <span style="color:#66d9ef">by</span> password1;<span style="color:#f92672">//</span><span style="color:#960050;background-color:#1e0010">使用带有口令的</span>role1生效
<span style="color:#66d9ef">sql</span><span style="color:#f92672">&gt;</span><span style="color:#66d9ef">set</span> <span style="color:#66d9ef">role</span> <span style="color:#66d9ef">all</span>;<span style="color:#f92672">//</span><span style="color:#960050;background-color:#1e0010">使用该用户的所有角色生效</span>
<span style="color:#66d9ef">sql</span><span style="color:#f92672">&gt;</span><span style="color:#66d9ef">set</span> <span style="color:#66d9ef">role</span> <span style="color:#66d9ef">none</span>;<span style="color:#f92672">//</span><span style="color:#960050;background-color:#1e0010">设置所有角色失效</span>
<span style="color:#66d9ef">sql</span><span style="color:#f92672">&gt;</span><span style="color:#66d9ef">set</span> <span style="color:#66d9ef">role</span> <span style="color:#66d9ef">all</span> <span style="color:#66d9ef">except</span> role1;<span style="color:#f92672">//</span><span style="color:#960050;background-color:#1e0010">除</span>role1外的该用户的所有其它角色生效<span style="color:#960050;background-color:#1e0010">。</span>
<span style="color:#66d9ef">sql</span><span style="color:#f92672">&gt;</span><span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> SESSION_ROLES;<span style="color:#f92672">//</span><span style="color:#960050;background-color:#1e0010">查看当前用户的生效的角色。</span>
</code></pre></div></li>
<li>
<p>修改指定用户，设置其默认角色</p>
<p>alter user user1 default role role1;</p>
</li>
<li>
<p>删除角色</p>
<p>drop role role1</p>
<p>角色删除后，原来拥用该角色的用户就不再拥有该角色了，相应的权限也就没有。</p>
</li>
<li>
<p>不能使用WITH GRANT OPTION为角色授予对象权限，可以使用WITH ADMIN OPTION 为角色授予系统权限,取消时不是级联</p>
</li>
</ol>
<h2 id="oracle权限管理">Oracle权限管理</h2>
<h3 id="权限分类">权限分类</h3>
<p>系统权限：系统规定用户使用数据库的权限。（系统权限是对用户而言)。</p>
<p>实体权限：某种权限用户对其它用户的表或视图的存取权限。（是针对表或视图而言的）。</p>
<h3 id="系统权限管理">系统权限管理</h3>
<ol>
<li>
<p>系统权限分类</p>
<p>DBA: 拥有全部特权，是系统最高权限，只有DBA才可以创建数据库结构。</p>
<p>RESOURCE:拥有Resource权限的用户只可以创建实体，不可以创建数据库结构。</p>
<p>CONNECT:拥有Connect权限的用户只可以登录Oracle，不可以创建实体，不可以创建数据库结构。</p>
<p>对于普通用户：授予connect、resource权限</p>
<p>对于dba用户：授予connect、resource权限</p>
</li>
<li>
<p>系统权限授权命令</p>
<p>系统权限只能有DBA用户授出：sys/system（最开始是这两个用户）</p>
<p>授权命令：SQL&gt; grant connect, resource, dba to 用户名1 [,用户名2]&hellip;;</p>
<p>普通用户通过授权可以具有和system相同的权限，但是不能达到和sys相同的用户权限，system用户的权限也可以被回收</p>
<p>​</p>
</li>
<li>
<p>系统权限传递与回收</p>
<p>增加with admin opinion 选项，则得带的权限可以传递</p>
<pre><code>grant connect, resorce to user1 with admin option;  //可以传递所获权限。
</code></pre><p>系统权限的回收只能由DBA用户回收</p>
<pre><code>revoke connect,resource from user1
</code></pre><p>如果使用WITH ADMIN OPTION为某个用户授予系统权限，那么对于被这个用户授予相同权限的所有用户来说，取消该用户的系统权限并不会级联取消这些用户的相同权限。</p>
<p>系统权限无级联，即A授予B权限，B授予C权限，如果A收回B的权限，C的权限不受影响；系统权限可以跨用户回收，即A可以直接收回C用户的权限。</p>
</li>
</ol>
<h3 id="实体权限管理">实体权限管理</h3>
<ol>
<li>
<p>实体权限分类</p>
<p>select,update,insert,alter,index,delete,all(all包含所有权限),execute(执行存储过程的权限)</p>
</li>
<li>
<p>实体权限的授予</p>
<p>将权限授予用户</p>
<pre><code> grant select, update, insert on product to user02;
 grant all on product to user02;
</code></pre><p>将表的操作授予全体用户</p>
<pre><code>grant all on tablename to public
</code></pre></li>
<li>
<p>dba的实体权限</p>
<p>DBA用户可以操作全体用户的任意基表(无需授权，包括删除)</p>
</li>
<li>
<p>实体权限传递与回收</p>
<pre><code>grant select, update on product to user02 with grant option; // user02得到权限，并可以传递。
Revoke select, update on product from user02;  //传递的权限将全部丢失。
</code></pre><p>如果取消某个用户的对象权限，那么对于这个用户使用WITH GRANT OPTION授予权限的用户来说，同样还会取消这些用户的相同权限，也就是说取消授权时级联的。</p>
</li>
</ol>


    
    
        <div class="related">

</div>
    

</div>


        

    </div>

</section>



<section class="section">
  <div class="container has-text-centered">
    <p>© <a href="https://github.com/pavel-pi">Pavel Pi</a> 2020</p>
    
      <p>Powered by <a href="https://gohugo.io/">Hugo</a> &amp; <a href="https://github.com/pavel-pi/kiss-em">Kiss'Em</a>.</p>
    
  </div>
</section>

</body>
</html>

